CC=mpiCC
SINGLE=-c
BEFORE=-x c++ -std=c++11
LIBS=-lfst -ldl -lboost_mpi -lboost_serialization -lboost_thread -lboost_system
OPT=-O3

all: train-hmm

train-hmm: FstUtils.o HmmModel.o train-hmm.o
	     $(CC) FstUtils.o HmmModel2.o train-hmm.o  $(LIBS) -o train-hmm

train-hmm.o: FstUtils.o HmmModel.o train-hmm.cc ClustersComparer.h StringUtils.h
	    $(CC) $(BEFORE) $(SINGLE) train-hmm.cc $(OPT)

HmmModel.o: FstUtils.o HmmModel.cc HmmModel.h Samplers.h VocabEncoder.h UnsupervisedSequenceTaggingModel.h
	     $(CC) $(BEFORE) $(SINGLE) HmmModel.cc $(OPT)

FstUtils.o: FstUtils.cc FstUtils.h
	   $(CC) $(BEFORE) $(SINGLE) FstUtils.cc $(OPT)

clean:
	rm -rf train-hmm FstUtils.o HmmModel.o train-hmm.o
